# GEMINI.md: ns3_gazebo 워크스페이스 요약

이 문서는 `ns3_gazebo` 워크스페이스의 구조, 목적, 핵심 기술에 대한 요약 정보를 제공하며, AI 어시스턴트의 작업 컨텍스트로 사용됩니다.

---

## 1. 프로젝트 목표 (Project Goal)

**ROS2 기반 분산 로봇 시스템을 위한 통합 시뮬레이션 플랫폼 구축**

- **물리 시뮬레이션 (Gazebo)**, **네트워크 시뮬레이션 (ns-3)**, **로봇 자율 주행 S/W (ROS2)**를 연동하여 현실과 유사한 가상 환경에서 로봇 시스템의 성능, 안정성, 보안을 종합적으로 테스트하고 검증하는 것을 목표로 합니다.

---

## 2. 핵심 기술 스택 (Core Technology Stack)

- **시뮬레이터**: 
  - ns-3 (현재 v3.29, v3.45로 업그레이드 예정)
  - Gazebo (현재 v9, Gazebo Harmonic으로 업그레이드 예정)
- **로봇 프레임워크**: ROS2
- **빌드 시스템**: colcon, CMake, Python setuptools
- **언어**: C++, Python

---

## 3. 주요 아키텍처 및 메커니즘

- **TAP 브리지**: ns-3의 가상 네트워크와 호스트 시스템의 실제 네트워크 인터페이스를 연결하는 핵심 기술. 이를 통해 ROS2 노드들의 통신이 ns-3 시뮬레이터를 거치게 됩니다.
- **네트워크 네임스페이스 (NNS)**: 각 로봇 노드(프로세스)를 네트워크상에서 격리시켜, 독립적인 IP 주소와 라우팅 테이블을 갖게 하는 리눅스 기능. `testbed_runner.py`가 이를 활용하여 각 로봇을 개별 환경에서 실행합니다.
- **CSV 기반 테스트 시나리오**: `csv_setup/` 디렉터리의 CSV 파일을 통해 발행/구독 토픽, 주기, QoS 등 복잡한 테스트 시나리오를 유연하게 정의합니다.
- **Pipe 기반 결과 로깅**: 테스트 노드에서 측정된 성능 데이터(예: 지연 시간)를 Named Pipe (`_testbed_pipe.pipe`)에 기록하고, GUI 애플리케이션이 이를 읽어 실시간으로 시각화합니다.
- **시뮬레이션 시간 동기화**: `ns3_testbed_simtime`에서는 ns-3 시뮬레이터의 내부 시간을 공유 메모리를 통해 ROS2 노드와 동기화합니다. 이를 통해 시스템 부하와 무관한, 결정론적이고 반복 가능한 성능 측정이 가능합니다.

---

## 4. 디렉터리 구조 및 역할

| 디렉터리 | 역할 |
|---|---|
| `src/` | 독립적으로 ns-3 네트워크 시뮬레이션을 실행하는 C++ 프로그램. |
| `ns3_gazebo_plugin/` | Gazebo 시작 시 자동으로 ns-3 시뮬레이션을 구동하는 Gazebo World 플러그인. |
| `ns3_gazebo_ws/` | Gazebo 내 로봇의 물리적 위치를 ns-3 시뮬레이션 내 노드 위치와 동기화하는 ROS2 노드. |
| `ns3_testbed/` | **(주요 테스트 환경)** Python 기반의 테스트 실행기, 로봇 노드, GUI를 포함하는 통합 테스트 프레임워크. |
| `ns3_testbed_simtime/` | **(고급 테스트 환경)** ns-3의 시뮬레이션 시간을 기준으로 성능을 측정하는 C++ 기반의 정밀 테스트 프레임워크. |
| `ns3_wifi_tap_test/` | ns-3의 TAP 브리지 기능을 다양한 네트워크 모드(Ad-hoc, Infrastructure 등)에서 검증하는 저수준 테스트 유틸리티. |
| `example_policy/` | SROS2 보안 기능(Access Control)을 적용하기 위한 정책 예제 파일. |
| `drawings/` | 시스템 아키텍처를 시각적으로 설명하는 다이어그램. |
| `tasks/` | PRD 및 생성된 작업 목록과 같은 프로젝트 관리 문서. |

---

## 5. 현재 주요 과제

- **ns-3 및 Gazebo 버전 업그레이드**
  - **목표**: ns-3.29 → ns-3.45, Gazebo 9 → Gazebo Harmonic
  - **상세 요구사항**: `/tasks/prd-simulator-upgrade.md` 참조
  - **세부 작업 목록**: `/tasks/tasks-prd-simulator-upgrade.md` 참조

---

## 6. 작업 규칙 (Work Rules)

1.  **워크스페이스 이해**: 작업 전 `@GEMINI.md` 문서를 읽고 현재 워크스페이스의 구조를 이해합니다.
2.  **과제 목표 이해**: 작업 전 `@tasks/prd-simulator-upgrade.md` 문서를 읽고 과제의 목표를 이해합니다.
3.  **세부 작업 분석**: 작업 전 `@tasks/tasks-prd-simulator-upgrade.md` 문서를 읽고 진행해야 할 세부 작업을 분석합니다.
4.  **작업 절차 준수**: 작업 전 `@tasks/process-task-list.md` 문서를 읽고 상세 작업 절차 및 규칙을 준수합니다.
